
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scicat Dataset Ingestor &#8212; SciCat Dataset Ingestor 0.10.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="scicat_dataset_ingestor" href="scicat_dataset_ingestor.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="scicat-dataset-ingestor">
<h1>Scicat Dataset Ingestor<a class="headerlink" href="#scicat-dataset-ingestor" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/jkotan/scingestor/actions"><img alt="" src="https://github.com/jkotan/scingestor/actions/workflows/tests.yml/badge.svg" /></a>
<a class="reference external" href="https://jkotan.github.io/scingestor/index.html"><img alt="" src="https://img.shields.io/badge/Documentation-webpages-ADD8E6.svg" /></a>
<a class="reference external" href="https://pypi.python.org/pypi/scingestor"><img alt="" src="https://img.shields.io/pypi/v/scingestor.svg" /></a>
<a class="reference external" href="https://pypi.python.org/pypi/scingestor/"><img alt="" src="https://img.shields.io/pypi/pyversions/scingestor.svg" /></a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">scingestor</span></code> python package provides a support for scripts which
ingest Datasets and OrigDatablocks into the SciCat metadata server.</p>
<div class="section" id="id1">
<h2>scicat_dataset_ingestor<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>SciCat Dataset ingestor server ingests scan metadata just after a scan
is finished. It can be executed by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scicat_dataset_ingestor</span> <span class="o">-</span><span class="n">c</span> <span class="o">~/.</span><span class="n">scingestor</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<div class="section" id="configuration-variables">
<h3>Configuration variables<a class="headerlink" href="#configuration-variables" title="Permalink to this headline">¶</a></h3>
<p>The configuration written in YAML can contain the following variables</p>
<ul class="simple">
<li><p><strong>scicat_url</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;http://localhost:3000/api/v3&quot;</span></code></p></li>
<li><p><strong>ingestor_credential_file</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>beamtime_dirs</strong> <em>(list&lt;str&gt;)</em> , default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p></li>
<li><p><strong>beamtime_base_dir</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>ingestor_var_dir</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>ingestor_username</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;ingestor&quot;</span></code></p></li>
<li><p><strong>dataset_pid_prefix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>dataset_update_strategy</strong> (<code class="docutils literal notranslate"><span class="pre">&quot;no&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;patch&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;create&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mixed&quot;</span></code>) , default: <code class="docutils literal notranslate"><span class="pre">&quot;patch&quot;</span></code></p></li>
<li><p><strong>relative_path_in_datablock</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>scandir_blacklist</strong> <em>(list&lt;str&gt;)</em> , default: <code class="docutils literal notranslate"><span class="pre">[&quot;/gpfs/current/scratch_bl&quot;,</span> <span class="pre">&quot;/gpfs/current/processed&quot;,</span> <span class="pre">&quot;/gpfs/current/shared&quot;]</span></code></p></li>
<li><p><strong>beamtimeid_blacklist_file</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>beamtime_type_blacklist</strong> <em>(list&lt;str&gt;)</em> , default: <code class="docutils literal notranslate"><span class="pre">[&quot;P&quot;]</span></code></p></li>
<li><p><strong>chmod_json_files</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>max_scandir_depth</strong> <em>(int)</em>, default: <code class="docutils literal notranslate"><span class="pre">-1</span></code></p></li>
<li><p><strong>oned_in_metadata</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>max_oned_size</strong> <em>(int)</em> , default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>scan_metadata_postfix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;.scan.json&quot;</span></code></p></li>
<li><p><strong>datablock_metadata_postfix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;.origdatablock.json&quot;</span></code></p></li>
<li><p><strong>attachment_metadata_postfix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;.attachment.json&quot;</span></code></p></li>
<li><p><strong>metadata_in_var_dir</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>use_corepath_as_scandir</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>beamtime_filename_postfix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;beamtime-metadata-&quot;</span></code></p></li>
<li><p><strong>beamtime_filename_prefix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;.json&quot;</span></code></p></li>
<li><p><strong>datasets_filename_pattern</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;scicat-datasets-{beamtimeid}.lst&quot;</span></code></p></li>
<li><p><strong>ingested_datasets_filename_pattern</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;scicat-ingested-datasets-{beamtimeid}.lst&quot;</span></code></p></li>
<li><p><strong>file_dataset_metadata_generator</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nxsfileinfo</span> <span class="pre">metadata</span> <span class="pre">-k4</span> <span class="pre">-o</span> <span class="pre">{metapath}/{scanname}{scanpostfix}</span>&#160; <span class="pre">-b</span> <span class="pre">{beamtimefile}</span> <span class="pre">-p</span> <span class="pre">{beamtimeid}/{scanname}</span>&#160; <span class="pre">-w</span> <span class="pre">{ownergroup}</span> <span class="pre">-c</span> <span class="pre">{accessgroups}</span> <span class="pre">{masterfile}</span></code></p></li>
<li><p><strong>dataset_metadata_generator</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nxsfileinfo</span> <span class="pre">metadata</span> <span class="pre">-k4</span> <span class="pre">-o</span> <span class="pre">{metapath}/{scanname}{scanpostfix}</span>&#160; <span class="pre">-c</span> <span class="pre">{accessgroups}</span> <span class="pre">-w</span> <span class="pre">{ownergroup}</span> <span class="pre">-b</span> <span class="pre">{beamtimefile}</span> <span class="pre">-p</span> <span class="pre">{beamtimeid}/{scanname}&quot;</span></code></p></li>
<li><p><strong>datablock_metadata_generator</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nxsfileinfo</span> <span class="pre">origdatablock</span>&#160; <span class="pre">-s</span> <span class="pre">*.pyc,*{datablockpostfix},*{scanpostfix},*~</span>&#160; <span class="pre">-p</span> <span class="pre">{doiprefix}/{beamtimeid}/{scanname}</span>&#160; <span class="pre">-w</span> <span class="pre">{ownergroup}</span> <span class="pre">-c</span> <span class="pre">{accessgroups}</span> <span class="pre">-o</span> <span class="pre">{metapath}/{scanname}{datablockpostfix}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>datablock_metadata_stream_generator</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nxsfileinfo</span> <span class="pre">origdatablock</span>&#160; <span class="pre">-s</span> <span class="pre">*.pyc,*{datablockpostfix},*{scanpostfix},*~</span>&#160; <span class="pre">-w</span> <span class="pre">{ownergroup}</span> <span class="pre">-c</span> <span class="pre">{accessgroups}</span> <span class="pre">-p</span> <span class="pre">{doiprefix}/{beamtimeid}/{scanname}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>datablock_metadata_generator_scanpath_postfix</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">{scanpath}/{scanname}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>attachment_metadata_generator</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nxsfileinfo</span> <span class="pre">attachment</span>&#160; <span class="pre">-w</span> <span class="pre">{ownergroup}</span> <span class="pre">-c</span> <span class="pre">{accessgroups}</span> <span class="pre">-o</span> <span class="pre">{metapath}/{scanname}{attachmentpostfix}</span> <span class="pre">{plotfile}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>metadata_generated_callback</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nxsfileinfo</span> <span class="pre">groupmetadata</span>&#160; <span class="pre">{lastmeasurement}</span> <span class="pre">-m</span> <span class="pre">{metapath}/{scanname}{scanpostfix}</span> <span class="pre">-d</span> <span class="pre">{metapath}/{scanname}{datablockpostfix}</span> <span class="pre">-a</span> <span class="pre">{metapath}/{scanname}{attachmentpostfix}</span> <span class="pre">-p</span> <span class="pre">{beamtimeid}/{lastmeasurement}</span> <span class="pre">-f</span> <span class="pre">-k4</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>metadata_group_map_file</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>raw_metadata_callback</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>skip_multi_datablock_ingestion</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>skip_multi_attachment_ingestion</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>skip_scan_dataset_ingestion</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>call_metadata_generated_callback</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>metadata_group_map_file_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--group-map-file</span> <span class="pre">{groupmapfile}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>raw_metadata_callback_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--raw</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>execute_commands</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>plot_file_extension_list</strong> <em>(list&lt;str&gt;)</em> , default: <code class="docutils literal notranslate"><span class="pre">[&quot;png&quot;,</span> <span class="pre">&quot;nxs&quot;,</span> <span class="pre">&quot;h5&quot;,</span> <span class="pre">&quot;ndf&quot;,</span> <span class="pre">&quot;nx&quot;,</span> <span class="pre">&quot;fio&quot;]</span></code></p></li>
<li><p><strong>master_file_extension_list</strong> <em>(list&lt;str&gt;)</em> , default: <code class="docutils literal notranslate"><span class="pre">[&quot;nxs&quot;,</span> <span class="pre">&quot;h5&quot;,</span> <span class="pre">&quot;ndf&quot;,</span> <span class="pre">&quot;nx&quot;,</span> <span class="pre">&quot;fio&quot;]</span></code></p></li>
<li><p><strong>chmod_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">-x</span> <span class="pre">{chmod}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>relative_path_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">-r</span> <span class="pre">{relpath}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>oned_dataset_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--oned</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>max_oned_dataset_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--max-oned-size</span> <span class="pre">{maxonedsize}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>override_attachment_signals_generator_switch</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--override</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>hidden_attributes_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">-n</span> <span class="pre">{hiddenattributes}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>hidden_attributes</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;nexdatas_source,nexdatas_strategy,units&quot;</span></code></p></li>
<li><p><strong>attachment_signals_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">-s</span> <span class="pre">{signals}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>attachment_axes_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">-e</span> <span class="pre">{axes}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>attachment_frame_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">-m</span> <span class="pre">{frame}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>attachment_signal_names</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>attachment_axes_names</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>attachment_image_frame_number</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></li>
<li><p><strong>ingest_dataset_attachment</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>override_attachment_signals</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>retry_failed_dataset_ingestion</strong> <em>(bool)</em> , default:<code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>retry_failed_attachment_ingestion</strong> <em>(bool)</em> , default:<code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>log_generator_commands</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>add_empty_units_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--add-empty-units</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>add_empty_units</strong> <em>(bool)</em> , default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>metadata_copy_map_file</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>metadata_copy_map_file_generator_switch</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">--copy-map-file</span> <span class="pre">{copymapfile}</span> <span class="pre">&quot;</span></code></p></li>
<li><p><strong>inotify_timeout</strong> <em>(float)</em> , default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></li>
<li><p><strong>get_event_timeout</strong> <em>(float)</em> , default: <code class="docutils literal notranslate"><span class="pre">0.01</span></code></p></li>
<li><p><strong>ingestion_delay_time</strong> <em>(float)</em> , default: <code class="docutils literal notranslate"><span class="pre">5.0</span></code></p></li>
<li><p><strong>max_request_tries_number</strong> <em>(int)</em> , default: <code class="docutils literal notranslate"><span class="pre">100</span></code></p></li>
<li><p><strong>recheck_dataset_list_interval</strong> <em>(int)</em> , default: <code class="docutils literal notranslate"><span class="pre">1000</span></code></p></li>
<li><p><strong>recheck_beamtime_file_interval</strong> <em>(int)</em> , default: <code class="docutils literal notranslate"><span class="pre">1000</span></code></p></li>
<li><p><strong>request_headers</strong> <em>(dict&lt;str,str&gt;)</em> , default: <code class="docutils literal notranslate"><span class="pre">{&quot;Content-Type&quot;:</span> <span class="pre">&quot;application/json&quot;,</span> <span class="pre">&quot;Accept&quot;:</span> <span class="pre">&quot;application/json&quot;}</span></code></p></li>
<li><p><strong>scicat_datasets_path</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;Datasets&quot;</span></code></p></li>
<li><p><strong>scicat_proposals_path</strong> <em>(str)</em> , default: <code class="docutils literal notranslate"><span class="pre">&quot;Proposals&quot;</span></code></p></li>
<li><p><strong>scicat_datablocks_path</strong> <em>(str)</em>, default: <code class="docutils literal notranslate"><span class="pre">&quot;OrigDatablocks&quot;</span></code></p></li>
<li><p><strong>scicat_users_login_path</strong> <em>(str)</em>, default: <code class="docutils literal notranslate"><span class="pre">&quot;Users/login&quot;</span></code></p></li>
<li><p><strong>scicat_attachments_path</strong> <em>(str)</em>, default: <code class="docutils literal notranslate"><span class="pre">&quot;Datasets/{pid}/Attachments&quot;</span></code></p></li>
<li><p><strong>owner_access_groups_from_proposal</strong> <em>(bool)</em>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>metadata_keywords_without_checks</strong> <em>(list&lt;str&gt;)</em>, default: <code class="docutils literal notranslate"><span class="pre">[&quot;techniques&quot;,</span> <span class="pre">&quot;classification&quot;,</span> <span class="pre">&quot;createdBy&quot;,</span> <span class="pre">&quot;updatedBy&quot;,</span> <span class="pre">&quot;datasetlifecycle&quot;,</span> <span class="pre">&quot;numberOfFiles&quot;,</span> <span class="pre">&quot;size&quot;,</span> <span class="pre">&quot;createdAt&quot;,</span> <span class="pre">&quot;updatedAt&quot;,</span> <span class="pre">&quot;history&quot;,</span> <span class="pre">&quot;creationTime&quot;,</span> <span class="pre">&quot;version&quot;,</span> <span class="pre">&quot;scientificMetadata&quot;,</span> <span class="pre">&quot;endTime&quot;]</span></code></p></li>
</ul>
<p>e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beamtime_dirs</span><span class="p">:</span>
  <span class="o">-</span> <span class="s2">&quot;</span><span class="si">{homepath}</span><span class="s2">/gpfs/current&quot;</span>
  <span class="o">-</span> <span class="s2">&quot;</span><span class="si">{homepath}</span><span class="s2">/gpfs/commissioning&quot;</span>
<span class="n">scicat_url</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span>
<span class="n">ingestor_credential_file</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{homepath}</span><span class="s2">/gpfs/pwd&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="pattern-keywords-for-configuration-variables">
<h3>Pattern keywords for configuration variables<a class="headerlink" href="#pattern-keywords-for-configuration-variables" title="Permalink to this headline">¶</a></h3>
<p>The  <strong>datasets_filename_pattern</strong>, <strong>ingested_datasets_filename_pattern</strong>  and <strong>ingestor_var_dir</strong> can contain the <em>{beamtimeid}</em> and <em>{hostname}</em> keywords,  e.g. <code class="docutils literal notranslate"><span class="pre">&quot;scicat-ingested-datasets-{beamtimeid}.lst&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;scicat-ingested-datasets-{hostname}-{beamtimeid}.lst&quot;</span></code>  which is instantiated during the ingestor execution.</p>
<p>Similarly, <strong>file_dataset_metadata_generator</strong>, <strong>dataset_metadata_generator</strong>, <strong>datablock_metadata_generator</strong>,  <strong>datablock_metadata_stream_generator</strong>, <strong>datablock_metadata_generator_scanpath_postfix</strong>, <strong>attachment_metadata_generator</strong>, <strong>chmod_generator_switch</strong>, <strong>relative_path_generator_switch</strong>  can contain the following keywords: <em>{beamtimeid}</em> , <em>{scanname}</em>, <em>{chmod}</em>, <em>{scanpath}</em>, <em>{metapath}</em>, <em>{relpath}</em>, <em>{beamtimeid}</em>, <em>{beamline}</em>, <em>{doiprefix}</em>, <em>{beamtimefile}</em>, <em>{scanpostfix}</em>, <em>{datablockpostfix}</em>, <em>{ownergroup}</em>, <em>{accessgroups}</em>, <em>{hostname}</em>, <em>{hiddenattributes}</em>, <em>{ext}</em>, &quot;{masterfile}&quot;, &quot;{plotfile}&quot;</p>
<p>The &quot;{masterfile}&quot; is either equal to   &quot;{scanpath}/{scanname}.{ext}&quot; or &quot;{scanpath}/{scanname}/{scanname}.{ext}&quot;. Also
the &quot;{plotfile}&quot; is either equal to  &quot;{scanpath}/{scanname}.{plotext}&quot; or &quot;{scanpath}/{scanname}/{scanname}.{plotext}&quot;.</p>
</div>
</div>
<div class="section" id="scicat-dataset-ingest">
<h2>scicat_dataset_ingest<a class="headerlink" href="#scicat-dataset-ingest" title="Permalink to this headline">¶</a></h2>
<p>Re-ingestion script for SciCat Datasets and OrigDatablocks is usually
launched at the end of the beamtime.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scicat_dataset_ingest</span> <span class="o">-</span><span class="n">c</span> <span class="o">~/.</span><span class="n">scingestor</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>Its configuration written YAML like for <code class="docutils literal notranslate"><span class="pre">scicat_dataset_ingestor</span></code></p>
</div>
<div class="section" id="scicat-ingest">
<h2>scicat_ingest<a class="headerlink" href="#scicat-ingest" title="Permalink to this headline">¶</a></h2>
<p>General ingestion script for SciCat Models could be used for manual scicat model ingestion, e.g. Sample, Instrument or DerivedDataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scicat_ingest</span>  <span class="o">-</span><span class="n">m</span> <span class="n">Samples</span>  <span class="o">-</span><span class="n">c</span> <span class="o">~/.</span><span class="n">scingestor</span><span class="o">.</span><span class="n">yaml</span>  <span class="o">./</span><span class="n">metadata</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Its configuration written YAML like for <code class="docutils literal notranslate"><span class="pre">scicat_dataset_ingestor</span></code></p>
<div class="section" id="required-packages">
<h3>Required packages<a class="headerlink" href="#required-packages" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>python3 &gt;= 3.7</p></li>
<li><p>nxstools &gt;= 3.38.0</p></li>
<li><p>inotifyx (python3 version)</p></li>
<li><p>requests</p></li>
<li><p>setuptools</p></li>
<li><p>pyyaml</p></li>
<li><p>pytest (to run tests)</p></li>
<li><p>sphinx (to build the documentation)</p></li>
</ul>
</div>
<div class="section" id="install-from-sources">
<h3>Install from sources<a class="headerlink" href="#install-from-sources" title="Permalink to this headline">¶</a></h3>
<p>The code from <a class="reference external" href="https://github.com/jkotan/scingestor">https://github.com/jkotan/scingestor</a> can be built with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>To build the documentation use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build_sphinx</span>
</pre></div>
</div>
<p>The resulting documentation can be found below <code class="docutils literal notranslate"><span class="pre">build/sphinx/html</span></code> in
the root directory of the source distribution.</p>
<p>Finally, the package can be tested using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span> <span class="n">test</span>
</pre></div>
</div>
</div>
<div class="section" id="install-in-conda-or-pip-environment">
<h3>Install in conda or pip environment<a class="headerlink" href="#install-in-conda-or-pip-environment" title="Permalink to this headline">¶</a></h3>
<p>The code can be installed in your conda environment by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">myenv</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">myenv</span>

<span class="n">pip</span> <span class="n">install</span> <span class="n">inotifyx</span><span class="o">-</span><span class="n">py3</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">scingestor</span>
</pre></div>
</div>
<p>or in your pip environment by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="n">myvenv</span>
<span class="o">.</span> <span class="n">myvenv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>

<span class="n">pip</span> <span class="n">install</span> <span class="n">inotifyx</span><span class="o">-</span><span class="n">py3</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">scingestor</span>
</pre></div>
</div>
</div>
<div class="section" id="debian-and-ubuntu-packages">
<h3>Debian and Ubuntu packages<a class="headerlink" href="#debian-and-ubuntu-packages" title="Permalink to this headline">¶</a></h3>
<p>Debian <code class="docutils literal notranslate"><span class="pre">bookworm</span></code>, <code class="docutils literal notranslate"><span class="pre">bullseye</span></code>, <code class="docutils literal notranslate"><span class="pre">buster</span></code> or Ubuntu <code class="docutils literal notranslate"><span class="pre">lunar</span></code>, <code class="docutils literal notranslate"><span class="pre">jammy</span></code>, <code class="docutils literal notranslate"><span class="pre">focal</span></code> packages
can be found in the HDRI repository.</p>
<p>To install the debian packages, add the PGP repository key</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">su</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">s</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">repos</span><span class="o">.</span><span class="n">pni</span><span class="o">-</span><span class="n">hdri</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">debian_repo</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">gpg</span>  <span class="o">|</span> <span class="n">gpg</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="n">keyring</span> <span class="o">--</span><span class="n">keyring</span> <span class="n">gnupg</span><span class="o">-</span><span class="n">ring</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">trusted</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">hdri</span><span class="o">-</span><span class="n">repo</span><span class="o">.</span><span class="n">gpg</span> <span class="o">--</span><span class="kn">import</span>
<span class="nn">chmod</span> <span class="mi">644</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">trusted</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">hdri</span><span class="o">-</span><span class="n">repo</span><span class="o">.</span><span class="n">gpg</span>
</pre></div>
</div>
<p>and then download the corresponding source list, e.g. for <code class="docutils literal notranslate"><span class="pre">bookworm</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">repos</span><span class="o">.</span><span class="n">pni</span><span class="o">-</span><span class="n">hdri</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">bookworm</span><span class="o">-</span><span class="n">pni</span><span class="o">-</span><span class="n">hdri</span><span class="o">.</span><span class="n">list</span>
</pre></div>
</div>
<p>or <code class="docutils literal notranslate"><span class="pre">jammy</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">repos</span><span class="o">.</span><span class="n">pni</span><span class="o">-</span><span class="n">hdri</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">jammy</span><span class="o">-</span><span class="n">pni</span><span class="o">-</span><span class="n">hdri</span><span class="o">.</span><span class="n">list</span>
</pre></div>
</div>
<p>respectively.</p>
<p>Finally,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">scingestor</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="contents">
<h1>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scicat_dataset_ingestor.html">scicat_dataset_ingestor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scicat_dataset_ingestor.html#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="scicat_dataset_ingestor.html#synopsis">Synopsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="scicat_dataset_ingestor.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scicat_dataset_ingest.html">scicat_dataset_ingest</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scicat_dataset_ingest.html#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="scicat_dataset_ingest.html#synopsis">Synopsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="scicat_dataset_ingest.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scicat_ingest.html">scicat_ingest</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scicat_ingest.html#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="scicat_ingest.html#synopsis">Synopsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="scicat_ingest.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scingestor.html">scingestor package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.beamtimeWatcher">scingestor.beamtimeWatcher module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.configuration">scingestor.configuration module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.datasetIngest">scingestor.datasetIngest module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.datasetIngestor">scingestor.datasetIngestor module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.datasetWatcher">scingestor.datasetWatcher module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.logger">scingestor.logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.modelIngest">scingestor.modelIngest module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.pathConverter">scingestor.pathConverter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.safeINotifier">scingestor.safeINotifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor.scanDirWatcher">scingestor.scanDirWatcher module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scingestor.html#module-scingestor">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">SciCat Dataset Ingestor</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scicat_dataset_ingestor.html">scicat_dataset_ingestor</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicat_dataset_ingest.html">scicat_dataset_ingest</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicat_ingest.html">scicat_ingest</a></li>
<li class="toctree-l1"><a class="reference internal" href="scingestor.html">scingestor package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="scicat_dataset_ingestor.html" title="next chapter">scicat_dataset_ingestor</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, DESY, Jan Kotanski.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>